:root{
  --bg:#0b0b14; --panel:#161622; --ink:#e5e7eb; --muted:#9ca3af;
  --accent:#7c5cff; --accent-ink:#fff; --danger:#ff4d4d; --radius:16px; --chat-nudge: 12px;  
  --bubble-gap: 16px;

  /* normalized media sizing for image/GIF replies */
  --bubble-media-max-w: 300px;   /* hard ceiling inside the phone */
  --bubble-media-min-w: 180px;   /* never too tiny */
  --bubble-media-max-h: 220px;   /* keep tall gifs in check */
}

*{ box-sizing: border-box; }
html,body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
}

.hidden{ display:none !important; }
header{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 16px; border-bottom:1px solid #1f1f2e; background:#0e0e18;
}
h1{ font-size:20px; margin:0; letter-spacing:.3px; }
#roomInfo{ color:var(--muted); font-size:12px; }

#auth, #lobby, #game{ padding:20px; }
.card{
  background:var(--panel); padding:16px; border-radius:var(--radius);
  max-width:720px; margin:0 auto; box-shadow: 0 8px 30px rgba(0,0,0,.3);
}
label{ display:block; margin-bottom:8px; color:var(--muted); }
input{
  width:100%; padding:12px; background:#0f0f1b; color:#0f0f1b00; color:var(--ink);
  border:1px solid #23233a; border-radius:12px; outline:none;
}
.row{ display:flex; gap:8px; margin-top:12px; align-items:center; }
button{
  background:#23233a; color:var(--ink); border:none; padding:12px 14px;
  border-radius:12px; cursor:pointer; font-weight:600;
}
button.primary{ background:var(--accent); color:var(--accent-ink); }
button.secondary{ background:#2b2b45; }
button:disabled{ opacity:.6; cursor:not-allowed; }
.muted{ color:var(--muted); font-size:12px; }
.code{ width:120px; text-transform:uppercase; letter-spacing:2px; text-align:center; }
.codeBig{ font-size:28px; letter-spacing:6px; background:#0f0f1b; padding:8px 12px; border-radius:12px; }

/* Board layout */
.board{
  display:grid; grid-template-columns: 1.1fr 0.9fr; gap:16px;
  align-items:start;
}

/* Phone styling */
.phoneWrap{ display:flex; justify-content:center; }
.phone{
  width: 360px; height: 720px; background:#000; border-radius:38px;
  padding:10px; position:relative; border: 2px solid #222;
  box-shadow: 0 20px 60px rgba(0,0,0,.5);
}
.notch{
  position:absolute; top:8px; left:50%; transform:translateX(-50%);
  width:160px; height:28px; background:#000; border-bottom-left-radius:20px;
  border-bottom-right-radius:20px;
}
.screen{
  position:absolute; inset:10px; background:linear-gradient(180deg,#0c0d14,#0b0b14);
  border-radius:30px; padding:12px; overflow:hidden;
  border:1px solid #1d1d2a;
}
.statusRow{ display:flex; justify-content:space-between; color:#c7cad3; font-size:12px; padding:4px 6px; }
.badge{ background:#2f2f49; color:#cfd2ff; padding:2px 6px; border-radius:999px; font-size:11px; }

.contactBar{
  display:flex; align-items:center; justify-content:space-between;
  padding:8px 10px; margin:6px 6px 0; border-radius:12px;
  background:#111223; border:1px solid #23233a; color:#e5e7ff;
  font-weight:600; font-size:14px;
}
.contactStatus{ color:#9aa0b2; font-weight:500; font-size:12px; }

/* Phone bubbles alignment */
.chat{
  margin-top: var(--chat-nudge);
  height: calc(100% - 170px - var(--chat-nudge)); /* keep bottom actions visible */
  gap: var(--bubble-gap);
  overflow: auto;
  scroll-behavior: smooth;
  scroll-padding-bottom: 12px; /* little breathing room after last bubble */
}
/* Prompt = left */
.chat .prompt{
  align-self:flex-start;
  margin-right:auto;            /* anchor to left */
}

/* Responses = right */
.chat .reply{
  align-self:flex-end !important;
  margin-left:auto;             /* anchor to right */
  margin-top: 2px;
}

.bubble{
  max-width: 85%;
  padding:10px 12px;
  border-radius:16px;
  line-height:1.3;
  box-shadow: 0 4px 20px rgba(0,0,0,.25);
}

.prompt{
  background:#1b1b2d;
  color:#e5e7ff;
  border:1px solid #2b2b45;
  align-self:flex-start;              /* LEFT */
  border-top-left-radius: 8px;
  border-top-right-radius: 16px;
  border-bottom-left-radius: 6px;     /* subtle “tail” side */
  border-bottom-right-radius: 16px;
}
.reply{
  background:#f6f7ff;
  color:#0d0f17;
  align-self:flex-end;                /* RIGHT */
  border-top-left-radius: 16px;
  border-top-right-radius: 8px;
  border-bottom-left-radius: 16px;
  border-bottom-right-radius: 6px;    /* subtle “tail” side */
}
.reply.voteable{ cursor:pointer; outline: 2px solid transparent; }
.reply.voteable:hover{ outline-color: #7c5cff; }
.reply.selected{
  outline: 2px solid var(--accent);
  box-shadow: 0 0 0 2px rgba(124,92,255,.35) inset;
}
.reply .small{
  display:block;
  font-size:11px;
  color:#6b6f80;
  margin-top:6px;
  text-align:right;
}

/* normalize media replies so they never spill off the phone */
.bubble.reply.media{
  width: clamp(var(--bubble-media-min-w), 80%, var(--bubble-media-max-w));
  max-width: 85%;
  overflow: hidden;        /* keep rounded corners clean */
  padding: 8px;            /* tighter padding around media */
}

/* Image responses */
.imgMessage{
  display:block;
  width: 100%;
  height: auto;
  max-height: var(--bubble-media-max-h);
  object-fit: cover;       /* use 'contain' if you prefer no crop */
  border-radius: 12px;
  background:#0f0f1b;
}

/* Optional captions under media */
.bubble.reply.media .caption{
  margin-top: 6px;
  font-size: 12px;
  color: #6b6f80;
}

/* Hand thumbnails (general) */
.imgThumb{
  display:block;
  width:100%;
  aspect-ratio: 4 / 3;
  object-fit: cover;
  border-radius: 8px;
  background:#0f0f1b;
}

.actions{ position:absolute; bottom:12px; left:12px; right:12px; display:flex; justify-content:space-between; align-items:center; }

/* Hand (wrapper + base styles) */
.handWrap{ background:var(--panel); border-radius:var(--radius); padding:16px; }

/* Base grid (used by .handText as well) */
.hand{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; }

/* Card button */
.cardBtn{
  background:#0f0f1b; border:1px solid #23233a; border-radius:14px; padding:12px;
  text-align:left; min-height:64px; transition: transform .05s ease;
}
.cardBtn:hover{ transform: translateY(-1px); border-color:#3a3a60; }
.cardBtn.selected{ border-color:var(--accent); box-shadow: 0 0 0 2px rgba(124,92,255,.35) inset; }

#players{ display:flex; flex-wrap:wrap; gap:8px; margin:10px 0; }
.pill{ background:#0f0f1b; border:1px solid #23233a; padding:6px 10px; border-radius:999px; }

#leaderboard{ margin-top:16px; }
.lbRow{ display:flex; justify-content:space-between; padding:8px 10px; border-bottom:1px solid #23233a; }
.lbRow:last-child{ border-bottom:none; }

/* Toast */
.toast{
  position: fixed; left:50%; transform:translateX(-50%);
  bottom:20px; background:#16162a; color:#e5e7eb; padding:10px 14px;
  border-radius:10px; border:1px solid #2d2d45; box-shadow: 0 10px 30px rgba(0,0,0,.4);
}

/* Responsive: stack vertically on small screens */
@media (max-width: 980px){
  .board{ grid-template-columns: 1fr; }
  .phone{ margin: 0 auto; }
  .hand{ grid-template-columns: 1fr; }
}

/* ===== Hand split: text grid + media strip ===== */

/* Text cards — auto-size rows to content (no fixed row height) */
.handText{
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap:10px;
  align-items:start;
}
.handText .cardBtn{
  height:auto !important;   /* ensure rows grow per card content */
  min-height:64px;
  display:block;            /* natural flow for text */
  white-space: normal;
}
@media (max-width: 980px){
  .handText{ grid-template-columns: 1fr; }
}

/* Media strip sits below, horizontal scroll, independent from text grid */
.handMediaWrap{ margin-top: 14px; }
.handMediaTitle{ font-size:12px; color:var(--muted); margin: 0 0 6px 2px; }
.handMedia{
  display:flex; gap:10px; overflow-x:auto; padding-bottom: 6px;
  scroll-snap-type: x mandatory;
}

/* Buttons used inside the media strip */
.mediaBtn{
  flex: 0 0 180px;           /* fixed thumb width */
  height: 160px;             /* fixed card height */
  padding: 8px;
  display:flex; flex-direction:column; align-items:stretch; justify-content:flex-start;
  scroll-snap-align:start;
}

/* Thumbnails + caption inside media buttons */
.mediaBtn .imgThumb{
  width:100%; height:120px; object-fit:cover; border-radius:8px;
}
.mediaBtn .muted{
  margin-top:6px; font-size:12px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* Prompt image/gif support (mirror reply media sizing) */
.bubble.prompt.media{
  width: clamp(var(--bubble-media-min-w), 80%, var(--bubble-media-max-w));
  max-width: 85%;
  overflow: hidden;
  padding: 8px;
}
.bubble.prompt.media .caption{
  margin-top: 6px;
  font-size: 12px;
  color: #9aa0b2;
}

/* Sender labels above each response set */
.senderTag{
  color:#9aa0b2;
  font-size:12px;
  margin: 6px 8px 2px;
}

.deckList{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}
.deckItem{display:flex;gap:8px;align-items:center;background:#0f0f1b;border:1px solid #23233a;padding:8px 10px;border-radius:10px}

/* --- Drawer base (desktop defaults) --- */
.sidePanel { position: static; }
.desktopOnly { display: block; }
.mobileOnly { display: none; }

/* Floating “Hand” button (hidden on desktop) */
.fab{
  position: fixed; right: 16px; bottom: 20px;
  background: var(--accent); color: var(--accent-ink);
  border: none; border-radius: 999px; padding: 12px 16px;
  font-weight: 700; box-shadow: 0 10px 30px rgba(0,0,0,.4);
  z-index: 60; display: none;  /* desktop hidden */
}

/* Backdrop (hidden on desktop) */
.drawerBackdrop{
  position: fixed; inset: 0; background: rgba(0,0,0,.45);
  z-index: 55; display: none;
}
.drawerBackdrop.hidden{ display: none !important; }

/* Drawer header (mobile only) */
.drawerHeader{
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 8px;
}
.drawerHeader .title{ font-weight: 700; }
.drawerClose{
  background: #23233a; color: var(--ink);
  border: none; padding: 8px 10px; border-radius: 10px;
}

/* --- Mobile drawer behavior --- */
@media (max-width: 980px){
  .desktopOnly{ display: none; }
  .mobileOnly{ display: block; }

  /* Board becomes 1 column (phone centered) – you already have this */
  .board{ grid-template-columns: 1fr; }

  /* Make the right panel a fixed drawer from the right */
  .sidePanel{
    position: fixed; top: 0; right: 0; bottom: 0;
    width: min(92vw, 420px);
    transform: translateX(100%);
    transition: transform .25s ease;
    z-index: 70;
    /* Give the drawer its own background so content is readable */
    background: var(--panel);
    box-shadow: -20px 0 40px rgba(0,0,0,.4);
    overflow: auto;
    border-left: 1px solid #23233a;
    padding: 12px;  /* inner padding for the drawer */
  }

  /* The actual card already has a panel look; flatten inner card in drawer */
  .sidePanel .handWrap{
    background: transparent;
    box-shadow: none;
    padding: 8px;
    max-width: unset;
    margin: 0;
  }

  /* When open */
  body.drawerOpen .sidePanel{
    transform: translateX(0%);
  }
  body.drawerOpen .drawerBackdrop{
    display: block;
  }

  /* Show floating Hand button on mobile */
  .fab{ display: inline-flex; align-items: center; gap: 6px; }
}
